$(window).load((function(){$(".se-pre-con").fadeOut("slow")}));const FILTER_MIN="account-basic",FILTER_FULL="account-full",MAX_POST_RETURNS=8;$=jQuery;var $document=$(document),is_online=window.navigator.onLine,htaccess=$.trim($("#htaccess").val()),$btnExportExcel=$("#btnExport"),$loadingContainer=$(".progress-bar"),totalRequestUrl=0,currentMasterIndex=1,currentMasterProgress=0,logInfo=!0,isFilter=!1,is_chart_created=(htaccess=$.trim($("#is_htaccess_enable").val()),!1),navBarForm=$(".form-inline"),booClose=$(".close"),keyContainer=["#digitaslbi"],currentIndex=0,$account_filters=".account-filters",chkOpt=$("input[id='info-toggle']").val(),instagramSessionInput=$("#insta-session-id-val"),instaCookieName="insta-sess-cookie",instagramSessionCookie=Cookies.get(instaCookieName),applogs=function(t){},appinfo=function(t){},Config={session_key:instaCookieName,action:"account",infoFullMin:chkOpt,urlRequest:"includes/AjaxServices.php",userAgentStatus:is_online,btnSearch:"#btnSearch",txtSearch:"#txtSearch",queryFormTemplate:"#query-form-template",accountThumbPopup:"#account-thumbs",searchFormContainer:"#search-form-section",searchFormChartContainer:"#search-form-chart-section",lblCountSearchAccounts:"#CountSearchAccounts .badge.badge-pill",lblCountSearchHashtags:"#CountSearchHashtags .badge.badge-pill",lblSumOfVideoViews:"#SumOfVideoViews .badge.badge-pill",lblSumOfTotalLikes:"#SumOfTotalLikes .badge.badge-pill",lblSumOfTotalComments:"#SumOfTotalComments .badge.badge-pill",lblSumOfTotalShare:"#SumOfTotalShare .badge.badge-pill",lblSumOfTotalPosts:"#SumOfTotalPosts .badge.badge-pill",chartTemplate:"#chart-template",offlineMsg:"WARNING, you are offline or internet connection lost.",sessionError:'Please click on "Set Session" button and paste your Instagram sessionid to search account',queryAccounts:1,queryHashtags:1,queryLikes:1,queryComments:1,queryKeywords:1,queryPosts:1,getItem:function(t){return this[t].toString()?(applogs("Item found: "+t),this[t].toString()):(applogs("Item not found: "+t),!1)},setItem:function(t,e){applogs("Item request to set: "+t+" : "+e),this[t].toString()&&(applogs("Item found and set value: "+t+" : "+e),this[t]=e)}};$document.on("click",$account_filters,(function(){$($account_filters).removeClass("active"),$(this).addClass("active"),$("input[id='info-toggle']").val($(this).data("val")),Config.setItem("infoFullMin",$(this).data("val")),appinfo($(this).data("val"))}));var _l=function(t){!0===logInfo&&applogs(t)};function hasProp(t,e){return applogs("obj"),applogs(t),applogs("prop"),applogs(e),void 0!==t&&Object.prototype.hasOwnProperty.call(t,e)}function isJSONString(t){try{JSON.parse(t)}catch(t){return!1}return!0}var log=document.querySelector("#log");["log","warn","error"].forEach((function(t){console[t]=function(t,e,o){return function(t){undefined(t),isJSONString(t)&&(t=JSON.stringify(t,void 0,2));var s=document.createElement("pre");s.classList.add(e),s.textContent=e+": "+t,o.appendChild(s)}}(0,t,log)})),$(document).ajaxError((function(t,e,o,s){errStr="",errStr+='<div class="alert alert-danger alert-dismissable">',errStr+='  <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>',errStr+="  <strong>Request/Response Error: </strong> Something went wrong or response not available.",errStr+="</div>",$(".error-handling .container-fluid").html(errStr).parent().removeClass("hide")}));var stateProgress=function(){applogs("currentMasterIndex: "+currentMasterIndex),applogs("currentMasterProgress: "+currentMasterProgress)};function fnExcelReport(t){var e=document.getElementById(t),o="<table border='2px'>";for(j=0;j<1;j++)o+="<tr bgcolor='#87AFC6'>"+e.rows[j].innerHTML+"</tr>";for(j=1;j<e.rows.length;j++)o+="<tr>"+e.rows[j].innerHTML+"</tr>";return o=(o=(o=(o+="</table>").replace(/<A[^>]*>|<\/A>/g,"")).replace(/<img[^>]*>/gi,"")).replace(/<input[^>]*>|<\/input>/gi,""),"data:application/vnd.ms-excel, "+encodeURIComponent(o)}var InstagramAccountSearch=function(){this.stateError=!1,this.txtProgressState=0,this.info=[],this.urlInstagram="https://www.instagram.com",this.urlInstagramNext=null,this.InstaJSON=null,this.currentIndex=0,this.currentIndexPost=0,this.isSearchingForNext=!1,this.errorContainer=$(".user-error"),this.infoContainer=$(".user-info"),this.tableWrapper=$("#search-account-table"),this.tableContentWrapper=$("#search-account-table.table-striped tbody"),this.txtIndicator=$(".txt-progress"),this.sendRequestUrl=Config.getItem("urlRequest"),this.infoFullMin=Config.getItem("infoFullMin")};appinfo(Config.getItem("infoFullMin")),InstagramAccountSearch.prototype.setAccount=function(){this.info=[],this.info.Biography=this.InstaJSON.graphql.user.biography,this.info.UserName=this.InstaJSON.graphql.user.username,this.info.FullName=this.InstaJSON.graphql.user.full_name,this.info.user_id=this.InstaJSON.graphql.user.id,this.info.Posts=this.InstaJSON.graphql.user.edge_owner_to_timeline_media.count,this.info.Followers=this.InstaJSON.graphql.user.edge_followed_by.count,this.info.Following=this.InstaJSON.graphql.user.edge_follow.count,this.info.AccountHref=this.urlInstagram+"/"+this.InstaJSON.graphql.user.username,this.info.Thumbs=[]},InstagramAccountSearch.prototype.buildAccountTableSummary=function(){applogs("Set Media Calling....");var t=this;applogs("No of total POST is, "+this.info.Posts),applogs("Current Index is, "+this.currentIndexPost),applogs("STEP: A currentIndexPost = "+this.currentIndexPost);var e=Math.ceil(this.info.Posts/8);if(appinfo(this.currentIndexPost+" - "+e),this.eventHandler("Likes & Comments: "+this.currentIndexPost+"/"+e+", "+this.info.FullName),this.txtProgressState=Math.ceil(100*this.currentIndexPost)/e,this.infoFullMin===FILTER_FULL){appinfo("Full request access"),applogs("JSON data is .... "),applogs(this.InstaJSON);var o=[],s=[],n=[],a=[],i=0,r=0,l=0,u={};if(applogs("InstaJSON debug data"),applogs(this.InstaJSON),hasProp(this.InstaJSON,"graphql")||hasProp(this.InstaJSON,"data")){if(applogs("Entering in graphql or data mode"),hasProp(this.InstaJSON.graphql,"user")||hasProp(this.InstaJSON.data,"user")){if(applogs("Entering in user"),hasProp(this.InstaJSON.graphql,"user"))o=this.InstaJSON.graphql.user.edge_owner_to_timeline_media.edges,u=this.InstaJSON.graphql.user;else{if(!hasProp(this.InstaJSON.data,"user"))return applogs("No data or graphql has user property"),!1;o=this.InstaJSON.data.user.edge_owner_to_timeline_media.edges,u=this.InstaJSON.data.user}applogs("JSON edge is printing"),applogs(o),$.each(o,(function(e,o){applogs("Displaying edge"),applogs(o),t.info.Thumbs.push({"thumb-src":Config.getItem("urlRequest")+"?url="+encodeURIComponent(o.node.thumbnail_resources[0].src),comments:o.node.edge_media_to_comment.count,likes:o.node.edge_media_preview_like.count}),s.push(o.node.edge_media_preview_like.count),n.push(o.node.edge_media_to_comment.count),a.push(o.node.video_view_count?o.node.video_view_count:0)})),$.each(s,(function(t,e){i+=parseInt(e)||0})),$.each(n,(function(t,e){r+=parseInt(e)||0})),$.each(a,(function(t,e){l+=parseInt(e)||0}))}applogs("Is Next Calling Value: "+this.isSearchingForNext),this.isSearchingForNext?(this.info.TotalLikes=parseInt(this.info.TotalLikes)+i,this.info.TotalComments=parseInt(this.info.TotalComments)+r,this.info.TotalViews=parseInt(this.info.TotalViews)+l,applogs("Searching for next....")):(applogs("likes sum value is: "+i),this.info.TotalLikes=i,applogs("comments sum value is: "+r),this.info.TotalComments=r,applogs("views sum value is: "+l),this.info.TotalViews=l),applogs("Check Has Next from JSON: "+u.edge_owner_to_timeline_media.page_info.has_next_page),!0===u.edge_owner_to_timeline_media.page_info.has_next_page?(this.urlInstagramNext=u.edge_owner_to_timeline_media.page_info.end_cursor,this.currentIndexPost++,applogs("STEP: B ++ currentIndexPost = "+this.currentIndexPost),this.isSearchingForNext=!0,applogs("Next page is requested")):(this.currentIndexPost=1,applogs("STEP: C Reset currentIndexPost = 1"),this.isSearchingForNext=!1,applogs("Next page not requested")),void 0===typeof this.info.TotalLikes&&(this.info.TotalLikes=0),void 0===typeof this.info.TotalComments&&(this.info.TotalComments=0),void 0===typeof this.info.TotalViews&&(this.info.TotalViews=0)}}},InstagramAccountSearch.prototype.buildTableRowsContent=function(){var t="";t+='<tr class="info-row">',t+='<td><input class="tbl-chk" type="checkbox"></td>',t+='<td><a target="_blank" href="'+this.info.AccountHref+'">'+this.info.UserName+"</a></td>",t+="<td>"+this.info.Biography+"</td>",t+="<td>"+this.info.Followers+"</td>",t+="<td>"+this.info.Following+"</td>",t+="<td>"+this.info.Posts+"</td>",this.info.TotalLikes?t+='<td><a href="#" data-toggle="modal" data-target="#thumb-'+this.info.UserName+'">'+this.info.TotalLikes+"</a></td>":t+="<td>0</td>",this.info.TotalComments?t+="<td>"+this.info.TotalComments+"</td>":t+="<td>0</td>",this.info.TotalViews?t+="<td>"+this.info.TotalViews+"</td>":t+="<td>0</td>",t+="<td>",t+='<a data-placement="top" data-toggle="tooltip" title="Edit">',t+='<button class="btn btn-primary btn-xs" data-title="Edit" data-toggle="modal" data-target="#edit"><span class="glyphicon glyphicon-pencil"></span></button>',t+="</a> ",t+='<a data-placement="top" data-toggle="tooltip" title="Delete">',t+='<button class="btn btn-danger btn-xs" data-title="Delete" data-toggle="modal" data-target="#delete"><span class="glyphicon glyphicon-trash"></span></button>',t+="</a>",t+="</td>",t+="</tr>";var e=$(Config.getItem("accountThumbPopup")).html();return Mustache.parse(e),rendered=Mustache.render(e,{username:this.info.UserName,"thumb-loop":this.info.Thumbs}),this.tableWrapper.after(rendered),t},InstagramAccountSearch.prototype.errorHandler=function(t){this.errorContainer.html(t)},InstagramAccountSearch.prototype.eventHandler=function(t,e){void 0===e?(this.txtIndicator.eq(this.currentIndex).css({width:this.txtProgressState+"%","border-top":"2px solid green"}),this.infoContainer.eq(this.currentIndex).html(t)):(this.txtIndicator.eq(this.currentIndex).css({width:this.txtProgressState+"%","border-top":"2px solid red"}),this.infoContainer.eq(this.currentIndex).removeClass("label-info").addClass(e).html(t))},InstagramAccountSearch.prototype.initNow=function(t,e){var o=this;applogs("Calling init now");var s=e;return s||(s={iUrl:t,request_action:"pull_account",sessionid:Config.getItem("session_key")},applogs("Sending payload is:"),applogs(s)),$.post(o.sendRequestUrl,s,(function(t,n,a){applogs("inside ajax request: Searching for Next, "+o.isSearchingForNext);var i=0;if(window._sharedData&&window._sharedData.error)return applogs("JSON has error, terminating process now."),o.stateError=!0,o.errorHandler(window._sharedData.error),i=Math.floor(currentMasterIndex/totalRequestUrl*100),currentMasterProgress=i,stateProgress(),currentMasterIndex++,!1;if(applogs("Success, no ajax error in response"),o.InstaJSON=window._sharedData.entry_data.ProfilePage.shift(),applogs("This is what response fetched"),applogs(o.InstaJSON),o.stateError=!1,o.InstaJSON.graphql)applogs("graphql found in response"),!0===o.InstaJSON.graphql.user.edge_owner_to_timeline_media.page_info.has_next_page&&o.infoFullMin==FILTER_FULL?(appinfo("Full request access II"),o.urlInstagramNext=o.InstaJSON.graphql.user.edge_owner_to_timeline_media.page_info.end_cursor,applogs("STEP: D ++ currentIndexPost = "+o.currentIndexPost),o.currentIndexPost++,o.isSearchingForNext=!0,applogs("Next page is requested graphql: end_cursor - "+o.urlInstagramNext)):(o.currentIndexPost=1,applogs("STEP: E Reset currentIndexPost = 1"),o.isSearchingForNext=!1,applogs("STEP: Next page not requested graphql: end_cursor - "+o.urlInstagramNext));else{if(!o.InstaJSON.data||o.infoFullMin!==FILTER_FULL)return applogs("No data or graphql found"),!1;appinfo("Full request access III"),!0===o.InstaJSON.data.user.edge_owner_to_timeline_media.page_info.has_next_page?(o.urlInstagramNext=o.InstaJSON.data.user.edge_owner_to_timeline_media.page_info.end_cursor,applogs("STEP: F ++ currentIndexPost = "+o.currentIndexPost),o.currentIndexPost++,o.isSearchingForNext=!0,applogs("Next page is requested data: end_cursor - "+o.urlInstagramNext)):(applogs("STEP: G Reset currentIndexPost = 1"),o.currentIndexPost=1,o.isSearchingForNext=!1,applogs("Next page not requested data: end_cursor - "+o.urlInstagramNext))}if(applogs("Requesting action is:"+s.request_action),"pull_account"===s.request_action){if(!0===o.InstaJSON.graphql.user.is_private)return applogs("Requested account is private"),o.eventHandler("This is Private account: "+o.InstaJSON.graphql.user.full_name,"label-danger"),!1;applogs("Setting user account with information"),o.setAccount(),e={keyword:o.info.user_id,request_action:"pull_media",sessionid:Config.getItem("session_key"),max_id:o.urlInstagramNext},o.infoFullMin===FILTER_FULL&&(appinfo("Full request access IV"),applogs("Call ing init now again...with max is and pull media flag"),o.initNow(o.info.UserName,e))}else applogs("running else condition"),o.buildAccountTableSummary(),!0===o.isSearchingForNext&&o.infoFullMin===FILTER_FULL?(appinfo("Full request access V"),e={keyword:o.info.user_id,request_action:"pull_media",max_id:o.urlInstagramNext,sessionid:Config.getItem("session_key")},o.initNow(o.info.UserName,e)):(currentMasterIndex++,i=Math.floor(currentMasterIndex/totalRequestUrl*100),o.isSearchingForNext=!1,applogs("STEP: H Reset currentIndexPost = 1"),o.currentIndexPost=1,o.txtProgressState=0,o.eventHandler("Likes & Comments Done..."+o.info.FullName,"label-success"),applogs("Current Index "+o.currentIndex),applogs("totalRequestUrl "+totalRequestUrl),applogs("Current% "+i),currentMasterProgress=i,stateProgress(),o.tableContentWrapper.append(o.buildTableRowsContent()));o.infoFullMin==FILTER_MIN?(appinfo("Min request access VI: "+o.infoFullMin),applogs("Search account is Minimum flag"),currentMasterIndex++,i=Math.floor(currentMasterIndex/totalRequestUrl*100),o.isSearchingForNext=!1,applogs("STEP: I Reset currentIndexPost = 1"),o.currentIndexPost=1,o.txtProgressState=0,o.eventHandler("Likes & Comments Done..."+o.info.FullName,"label-success"),applogs("Current Index "+o.currentIndex),applogs("totalRequestUrl "+totalRequestUrl),applogs("Current% "+i),currentMasterProgress=i,stateProgress(),o.tableContentWrapper.append(o.buildTableRowsContent())):(appinfo("Requested info type is: "+o.infoFullMin),appinfo("Full request access VII"),applogs("Going in Full Condition and Search for Next is TRUE"),o.isSearchingForNext=!0)}))},$document.ready((function(){$("input[id='info-toggle']").on("change",(function(){chkOpt=$(this).val(),Config.setItem("infoFullMin",chkOpt)})),$(instagramSessionInput).on("change paste keyup",(function(){applogs("Session value reset: "+$(this).val()),Cookies.set(instaCookieName,$(this).val())})),instagramSessionCookie&&instagramSessionInput.val(instagramSessionCookie),$("[data-toggle=tooltip]").tooltip(),function(t){t.fn.flash=function(e){void 0===e?t(".container.preloader").addClass("hide"):t(".container.preloader").removeClass("hide").find(".progress-bar.progress-bar-striped").html(e)}}(jQuery);$(".wow").jQCloud([{text:"#Lovely",weight:10},{text:"#Good",weight:11},{text:"#Excellent",weight:12},{text:"#Wowmade",weight:13},{text:"#wow",weight:14},{text:"#Philadelphia",weight:15},{text:"#NewDone",weight:16},{text:"#Best",weight:17}],{shape:"elliptic",autoResize:!0,height:350});$(".oh").jQCloud([{text:"#SoBad",weight:21},{text:"#Nope",weight:22},{text:"#DoNotWorks",weight:23},{text:"#Useless",weight:24},{text:"#SoPoor",weight:25},{text:"#AnotherBad",weight:26},{text:"#ServiceOff",weight:27},{text:"#Ban",weight:28}],{colors:["#800026","#bd0026","#e31a1c","#fc4e2a","#fd8d3c"],shape:"elliptic",autoResize:!0,height:350});var t=function(){};t.prototype.setOfflineMode=function(){if(!1===this.userAgentStatus){var t=$("#offline-template").html();$(".wrapper").html(t)}},$(document).on("click","a.download",(function(){applogs("Download triggered....");var t=$(this),e=fnExcelReport(t.data("id"));t.attr("download","ExcelExport-"+(new Date).getTime()+".xls").attr("href",e).attr("target","_blank")}));var e=$(Config.getItem("txtSearch"));function o(){return"#"+("000000"+(16777215-Math.floor(16777216*Math.random())).toString(16)).substr(-6)}function s(t){(new Date).getTime();CanvasJS.addColorSet("customColorSet",[o(),o(),o(),o(),o(),o()]),new CanvasJS.Chart(t.chartId,{animationDuration:800,animationEnabled:!0,backgroundColor:"transparent",colorSet:"customColorSet",theme:"theme2",legend:{fontFamily:"calibri",fontSize:14,horizontalAlign:"left",verticalAlign:"center",itemTextFormatter:function(t){return t.dataPoint.name+": "+t.dataPoint.y}},title:{dockInsidePlotArea:!0,fontSize:20,fontWeight:"normal",horizontalAlign:"center",verticalAlign:"center",text:t.count},toolTip:{cornerRadius:0,fontStyle:"normal"},data:[{innerRadius:"80%",radius:"90%",legendMarkerType:"square",showInLegend:!0,startAngle:90,type:"doughnut",dataPoints:[{y:t.likes,name:"Likes"},{y:t.comments,name:"Comments"},{y:t.keywords,name:"Keywords"},{y:t.videos,name:"Video Views"}]}]}).render(),is_chart_created=!0}e.typeahead({multiple:!0,source:keyContainer,autoSelect:!0,minLength:0,items:20,showHintOnFocus:!0,dupChecker:!0}),e.change((function(){var t=e.typeahead("getActive");t&&(t.name,e.val())})),$document.ajaxStart((function(){$("body").flash("Please wait...request in progress")})).ajaxStop((function(){$("body").flash()})),booClose.modal("hide"),$("body").tooltip({selector:"[rel=tooltip]",trigger:"hover"}),$document.delegate('*[data-toggle="lightbox"]',"click",(function(t){t.preventDefault(),$(this).ekkoLightbox()})),$.sum=function(t){var e=0;return $.each(t,(function(t,o){e+=o})),e};var n=function(t){return this.filterKeywords=t.filterKeywords,this.keyWordsGroupCountValue=[],this.container=t.container||!1,this.keyword=t.keyword||!1,this.template=t.template||!1,this.callback=t.callback||!1,this.viewData={},this.chartOptions={},this.sumOfTotalViews=t.sumOfTotalViews,this.sumOfTotalLikes=t.sumOfTotalLikes,this.sumOfTotalComments=t.sumOfTotalComments,this.sumOfTotalShare=t.sumOfTotalShare,this.sumOfTotalPosts=t.sumOfTotalPosts,this.src="",this.caption="",this.like=0,this.comment=0,this.videos=0,this.name="",this.count=0,this.tblSummery=[],this.keywordSummery=[],this.imgSrcTemplate=[],this.setIndex=0,this.requestUrl=Config.getItem("urlRequest"),this.dataJson={},this.isNextOn=!1,this.sumOfCount=0,this.sumOfLikes=0,this.sumOfViews=0,this.sumOfPosts=0,this.sumOfComments=0,this._self=this,this.nextId=!1,this.maxRequestNo=4,this.requestRecursiveCycle=!0,this.limitRequest=0,this.action=t.action?t.action:"pull_hashtag",this};n.prototype.initStart=function(){var t=this;return $.post(t.requestUrl,{keyword:t.keyword,next:t.nextId,request_action:t.action},(function(e){if(void 0===window._sharedData||window._sharedData.hasOwnProperty("error"))return!1;e=window._sharedData.entry_data.ProfilePage.shift(),applogs(e),t.dataJson=e,!0===t.dataJson.graphql.hashtag.edge_hashtag_to_media.page_info.has_next_page?(t.isNextOn=!0,t.nextId=t.dataJson.graphql.hashtag.edge_hashtag_to_media.page_info.end_cursor):t.isNextOn=!1,applogs(e),t.buildMediaPost(e),t.limitRequest<1&&t.buildTopPostMedia(e),t.onCallNextRequest()}))},n.prototype.findHashtags=function(t){if(!t)return[];var e="a-zÀ-ÖØ-öø-ÿĀ-ɏɓ-ɔɖ-ɗəɛɣɨɯɲʉʋʻ̀-ͯḀ-ỿЀ-ӿԀ-ԧⷠ-ⷿꙀ-֑ꚟ-ֿׁ-ׂׄ-ׇׅא-תװ-״﬒-ﬨשׁ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﭏؐ-ؚؠ-ٟٮ-ۓە-ۜ۞-۪ۨ-ۯۺ-ۼۿݐ-ݿࢠࢢ-ࢬࣤ-ࣾﭐ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼ‌ก-ฺเ-๎ᄀ-ᇿ㄰-ㆅꥠ-꥿가-힯ힰ-퟿ﾡ-ￜァ-ヺー-ヾｦ-ﾟｰＡ-Ｚａ-ｚぁ-ゖ゙-ゞ㐀-䶿一-鿿꜀-뜿띀-렟-﨟〃々〻",o="0-9０-９",s=new RegExp("(?:^|[^"+e+o+"_]+)[#](["+e+o+"_]*["+e+"]+["+e+o+"_]*)(?![#"+e+o+"_]+)","g");return result=t.match(s),result?(res=result.map((function(t){return"#"+(t=t.trim().split("#"))[1]})),res):[]},n.prototype.keyWordsGroupCount=function(t){var e=this;t.forEach((function(t,o){e.keyWordsGroupCountValue[t]?e.keyWordsGroupCountValue[t].push(1):e.keyWordsGroupCountValue[t]=[1]}))},n.prototype.buildTemplateView=function(){var t=this,e="chart-view-"+(new Date).getTime();this.keyWordsGroupCount(keyContainer);var o=1,s=[];Object.keys(this.keyWordsGroupCountValue.sort()).forEach((function(t,e){s.push({name:t,val:this.keyWordsGroupCountValue[t].length})}),this),s.sort((function(t,e){return e.val-t.val})),s.forEach((function(e,s){t.keywordSummery.push({sno:o++,keyword:e.name,key_count:e.val})}),this),this.viewData={container:e,title:this.name,"table-summery":this.tblSummery,"key-table-summery":this.keywordSummery,"img-thumbs":this.imgSrcTemplate},this.container.append(Mustache.render(this.template,this.viewData)),this.chartOptions={chartId:e,count:this.count,likes:this.like,videos:this.videos,comments:this.comment,keywords:Object.keys(this.keyWordsGroupCountValue).length}},n.prototype.buildMediaPost=function(t){var e=this;e.name=t.graphql.hashtag.name,e.count=t.graphql.hashtag.edge_hashtag_to_media.count,e.sumOfCount+=parseInt(e.count)||0,$.each(t.graphql.hashtag.edge_hashtag_to_media.edges,(function(t,o){e.src=o.node.thumbnail_src,e.caption="N/A",o.node.edge_media_to_caption.edges.length&&(e.caption=o.node.edge_media_to_caption.edges[0].node.text),e.comment+=parseInt(o.node.edge_media_to_comment.count)||0,e.like+=parseInt(o.node.edge_liked_by.count)||0,e.findHashtags(e.caption).forEach((function(t){e.filterKeywords.push(t)}),this)}))},n.prototype.buildTopPostMedia=function(t){var e=this;$.each(t.graphql.hashtag.edge_hashtag_to_top_posts.edges,(function(t,o){var s=t+1;e.src=o.node.thumbnail_src,e.caption="N/A",o.node.edge_media_to_caption.edges.length&&(e.caption=o.node.edge_media_to_caption.edges[0].node.text),e.comment+=parseInt(o.node.edge_media_to_comment.count)||0,!0===o.node.is_video&&(e.videos+=parseInt(o.node.video_view_count)||0,e.sumOfViews+=parseInt(o.node.video_view_count)||0),e.like+=parseInt(o.node.edge_liked_by.count)||0,e.findHashtags(e.caption).forEach((function(t){e.filterKeywords.push(t)}),this),!0===o.node.is_video?e.imgSrcTemplate.push({img_src:Config.getItem("urlRequest")+"?url="+encodeURIComponent(e.src),likes_img:o.node.edge_liked_by.count,comments_img:o.node.edge_media_to_comment.count,video_views:parseInt(o.node.video_view_count)||0}):e.imgSrcTemplate.push({img_src:Config.getItem("urlRequest")+"?url="+encodeURIComponent(o.node.thumbnail_src),likes_img:o.node.edge_liked_by.count,comments_img:o.node.edge_media_to_comment.count}),e.tblSummery.push({no:s,posts:e.caption,likes_count:o.node.edge_liked_by.count,comments_count:o.node.edge_media_to_comment.count})}))},n.prototype.buildSummarizeCount=function(t){this.sumOfLikes+=this.like,this.sumOfComments+=this.comment,this.sumOfCount+=this.count,this.sumOfPosts+=this.count,this.sumOfTotalViews.text(parseInt(this.sumOfTotalViews.text())+this.sumOfViews),this.sumOfTotalLikes.text(parseInt(this.sumOfTotalLikes.text())+this.sumOfLikes),this.sumOfTotalComments.text(parseInt(this.sumOfTotalComments.text())+this.sumOfComments),this.sumOfTotalShare.text(parseInt(this.sumOfTotalShare.text())+Object.keys(this.keyWordsGroupCountValue).length),this.sumOfTotalPosts.text(parseInt(this.sumOfTotalPosts.text())+this.sumOfPosts)},n.prototype.onCallNextRequest=function(){var t=this;t.limitRequest++,t.isNextOn&&t.requestRecursiveCycle&&t.limitRequest<t.maxRequestNo?t.initStart():(t.buildTemplateView(),t.buildSummarizeCount(),t.callback(t.chartOptions))};new t;var a=parseInt(Config.getItem("queryHashtags"))-1,i=parseInt(Config.getItem("queryAccounts"))-1;$(Config.getItem("txtSearch")).on("keypress",(function(t){"13"==(t.keyCode?t.keyCode:t.which)&&(t.preventDefault(),$(Config.getItem("btnSearch")).trigger("click"))})),$(Config.getItem("btnSearch")).click((function(e){if(applogs("Btn Search Clicked"),!is_online)return alert(Config.getItem("offlineMsg")),!1;let o=$.trim(instagramSessionInput.val());!instagramSessionCookie&&o&&(applogs("Cookie set as: "+instaCookieName+" & value: "+Cookies.get(instaCookieName)),Cookies.set(instaCookieName,o));var r=$(Config.getItem("queryFormTemplate")).html();applogs("Template ready: "+r),Mustache.parse(r);var l=$(Config.getItem("searchFormContainer")),u=$(Config.getItem("txtSearch")).val();if(applogs("Search Query listed here: "+u),u){applogs("Search Query not empty");new t;var c,h=u.split(" "),d=0;$.each(h,(function(t,e){if(applogs("Parsing and finding search value type"),0===h[t].indexOf("#")){applogs("its a hashtag value: "+e),$(".form-control.insta-url[value='"+e+"']").length||(c=Mustache.render(r,{action:"hashtag",value:e,indicator:"txt-progress-none",input_action:"txt-insta-none",user_indicator:"user-info-none"})),l.append(c),a++;var o={filterKeywords:keyContainer,sumOfTotalViews:$(Config.getItem("lblSumOfVideoViews")),sumOfTotalLikes:$(Config.getItem("lblSumOfTotalLikes")),sumOfTotalComments:$(Config.getItem("lblSumOfTotalComments")),sumOfTotalShare:$(Config.getItem("lblSumOfTotalShare")),sumOfTotalPosts:$(Config.getItem("lblSumOfTotalPosts")),container:$(Config.getItem("searchFormChartContainer")),keyword:e.replace("#","")||"digitaslbi",template:$(Config.getItem("chartTemplate")).html(),action:"pull_hashtag",callback:s};new n(o).initStart()}if(0===h[t].indexOf("@")){if(applogs("its a user handle value: "+e),Cookies.get(instaCookieName)&&($(".form-control.insta-url[value='"+e+"']").length||(c=Mustache.render(r,{action:"instagram",value:e,indicator:"txt-progress",input_action:"txt-insta",user_indicator:"user-info"}))),l.append(c),i++,Cookies.get(instaCookieName)){if($.trim(e)){e=e.replace(/\@/,"",e),isFilter=!0;var u=new InstagramAccountSearch;u.currentIndex=d,u.eventHandler("Fetching data, please wait...."),u.initNow(null,{keyword:e,request_action:"pull_account",next:"false",sessionid:Config.getItem("session_key")}).done((function(t){u.stateError&&(applogs("STEP: J Reset currentIndexPost = 1"),u.currentIndexPost=1,u.eventHandler("Error in Instagram profile link, wrong link","label-danger"))}))}}else bootbox.alert(Config.getItem("sessionError"));d++}})),Config.setItem("queryHashtags",a),Config.setItem("queryAccounts",i),$(Config.getItem("lblCountSearchHashtags")).html(a),$(Config.getItem("lblCountSearchAccounts")).html(i)}}))}));